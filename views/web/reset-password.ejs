<% layout('layouts/blank.ejs') -%>

<div class="container-fluid vh-100 d-flex align-items-center justify-content-center p-4 bg-white">
    <div class="w-100" style="max-width: 400px;">
        <!-- Header -->
        <div class="text-center mb-5">
            <div class="mb-4">
                <i class="fa fa-key fa-4x text-primary"></i>
            </div>
            <h1 class="h3 fw-bold mb-2">Recuperar Contraseña</h1>
            <p class="text-muted mb-0">
                Ingresa tu correo electrónico para restablecer tu contraseña
            </p>
        </div>
        
        <!-- Formulario -->
        <form id="resetPasswordForm" class="needs-validation" novalidate>
            <div class="mb-4">
                <label for="email" class="form-label fw-bold">
                    <i class="fa fa-envelope me-2"></i>Correo Electrónico
                </label>
                <input type="email" 
                       class="form-control form-control-lg" 
                       id="email" 
                       placeholder="usuario@ejemplo.com" 
                       required
                       autofocus>
                <div class="invalid-feedback">
                    Por favor ingresa un correo electrónico válido.
                </div>
            </div>
            
            <!-- Botón Enviar -->
            <div class="d-grid mb-4">
                <button type="submit" class="btn btn-primary btn-lg">
                    <i class="fa fa-paper-plane me-2"></i>Enviar Enlace
                </button>
            </div>
            
            <!-- Mensaje de éxito -->
            <div id="successMessage" class="alert alert-success d-none mb-4" role="alert">
                <i class="fa fa-check-circle me-2"></i>
                <strong>¡Enlace enviado!</strong> Revisa tu correo electrónico.
            </div>
            
            <!-- Enlaces de navegación -->
            <div class="text-center pt-4 border-top">
                <div class="d-flex flex-column gap-3">
                    <a href="/sign-in" class="text-decoration-none">
                        <i class="fa fa-arrow-left me-2"></i>Volver a Iniciar Sesión
                    </a>
                    <a href="/sign-up" class="text-decoration-none">
                        <i class="fa fa-user-plus me-2"></i>¿No tienes cuenta? Regístrate
                    </a>
                </div>
            </div>
        </form>
        
        <!-- Información adicional -->
        <div class="text-center mt-4">
            <p class="text-muted small">
                <i class="fa fa-info-circle me-1"></i>
                Revisa tu carpeta de spam si no recibes el correo.
            </p>
        </div>
    </div>
</div>

<% block('scripts').append(`
<script>
document.getElementById('resetPasswordForm').addEventListener('submit', function(event) {
    event.preventDefault();
    event.stopPropagation();
    
    if (this.checkValidity()) {
        const email = document.getElementById('email').value;
        const successMessage = document.getElementById('successMessage');
        
        // Simulación de envío
        console.log('Solicitando recuperación para:', email);
        
        // Mostrar mensaje de éxito
        successMessage.classList.remove('d-none');
        
        // Deshabilitar formulario
        this.querySelectorAll('input, button').forEach(element => {
            element.disabled = true;
        });
        
        // Redireccionar después de 3 segundos
        setTimeout(() => {
            window.location.href = '/sign-in?message=reset-sent';
        }, 3000);
    }
    
    this.classList.add('was-validated');
});

// Auto-enfocar el campo de email
document.getElementById('email').focus();
</script>
`) %>

<% block('styles').append(`
<style>
    body {
        background: white;
    }
    
    .form-control-lg {
        padding: 0.75rem 1rem;
    }
    
    .btn-lg {
        padding: 0.75rem 1rem;
        font-weight: 500;
    }
    
    .text-decoration-none {
        color: var(--bs-primary);
        font-weight: 500;
        transition: color 0.2s ease;
    }
    
    .text-decoration-none:hover {
        color: var(--bs-primary-dark);
        text-decoration: underline !important;
    }
    
    .alert-success {
        border-radius: 8px;
        border: none;
        background-color: rgba(25, 135, 84, 0.1);
    }
    
    .border-top {
        border-top: 1px solid #dee2e6 !important;
    }
</style>
`) %>